<?xml version="1.0" encoding="ASCII"?>
<xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:tosca="http://tosca/1.0">
  <tosca:TopologyTemplate tosca_definitions_version="cloudify_dsl_1_1">
    <imports file="http://www.getcloudify.org/spec/cloudify/3.3.1/types.yaml"/>
    <imports file="http://dice-project.github.io/DICE-FCO-Plugin-Cloudify/0.1.1/plugin.yaml"/>
    <imports file="http://dice-project.github.io/cloudify-chef-plugin/1.3.2/plugin.yaml"/>
    <imports file="http://dice-project.github.io/DICE-Deployment-Cloudify/spec/fco/develop/plugin.yaml"/>
    <nodeTemplates node_template_name="vm1" type="dice.hosts.Large">
      <instances deploy="2"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="vm2" type="dice.hosts.Medium">
      <instances deploy="3"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="vm3" type="dice.hosts.Small">
      <instances deploy="1"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="storm_nimbus" type="dice.components.storm.Nimbus">
      <relationships type="dice.relationships.ContainedIn" target="vm1"/>
      <relationships type="dice.relationships.storm.ConnectedToZookeeperQuorum" target="zookeeper"/>
      <configurations property_name="taskTimeout" value="30"/>
      <configurations property_name="supervisorTimeout" value="60"/>
      <configurations property_name="monitorFrequency" value="10"/>
      <configurations property_name="queueSize" value="100000"/>
      <configurations property_name="retryTimes" value="5"/>
      <configurations property_name="retryInterval" value="2000"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="storm_vm2_supervisor" type="dice.components.storm.Worker">
      <relationships type="dice.relationships.ContainedIn" target="vm2"/>
      <relationships type="dice.relationships.storm.ConnectedToNimbus" target="storm_nimbus"/>
      <relationships type="dice.relationships.storm.ConnectedToZookeeperQuorum" target="zookeeper"/>
      <configurations property_name="workerStartTimeout" value="120"/>
      <configurations property_name="heartbeatFrequency" value="5"/>
      <configurations property_name="cpuCapacity" value="400"/>
      <configurations property_name="memoryCapacity" value="4096"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="storm_vm3_supervisor" type="dice.components.storm.Worker">
      <relationships type="dice.relationships.ContainedIn" target="vm3"/>
      <relationships type="dice.relationships.storm.ConnectedToNimbus" target="storm_nimbus"/>
      <relationships type="dice.relationships.storm.ConnectedToZookeeperQuorum" target="zookeeper"/>
      <configurations property_name="workerStartTimeout" value="120"/>
      <configurations property_name="heartbeatFrequency" value="5"/>
      <configurations property_name="cpuCapacity" value="400"/>
      <configurations property_name="memoryCapacity" value="4096"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="zookeeper_vm1_server" type="dice.components.zookeeper.Server">
      <relationships type="dice.relationships.ContainedIn" target="vm1"/>
      <relationships type="dice.relationships.zookeeper.MemberOfQuorum" target="zookeeper_quorum"/>
      <configurations property_name="tickTime" value="1500"/>
      <configurations property_name="initLimit" value="10"/>
      <configurations property_name="syncLimit" value="5"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="zookeeper_vm2_server" type="dice.components.zookeeper.Server">
      <relationships type="dice.relationships.ContainedIn" target="vm2"/>
      <relationships type="dice.relationships.zookeeper.MemberOfQuorum" target="zookeeper_quorum"/>
      <configurations property_name="tickTime" value="1500"/>
      <configurations property_name="initLimit" value="10"/>
      <configurations property_name="syncLimit" value="5"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="zookeeper_quorum" type="dice.components.zookeeper.Quorum">
      <relationships type="dice.relationships.zookeeper.QuorumContains" target="vm1"/>
      <relationships type="dice.relationships.zookeeper.QuorumContains" target="vm2"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="cassandra_seed" type="dice.components.cassandra.Seed">
      <relationships type="dice.relationships.ContainedIn" target="vm2"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="cassandra_vm2_worker" type="dice.components.cassandra.Worker">
      <relationships type="dice.relationships.ContainedIn" target="vm2"/>
      <relationships type="dice.relationships.cassandra.ConnectedToSeed" target="cassandra_seed"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="cassandra_vm1_worker" type="dice.components.cassandra.Worker">
      <relationships type="dice.relationships.ContainedIn" target="vm1"/>
      <relationships type="dice.relationships.cassandra.ConnectedToSeed" target="cassandra_seed"/>
    </nodeTemplates>
    <nodeTemplates node_template_name="wikistats_application" type="dice.components.storm.Topology">
      <properties property_name="application" value="wikistats-topology-0.1.0-SNAPSHOT.jar"/>
      <properties property_name="topology_name" value="wikistats_topology"/>
      <properties property_name="topology_class" value="rg.apache.storm.starter.WikimediaTopology"/>
      <relationships type="dice.relationships.storm.SubmittedBy" target="storm_nimbus"/>
      <relationships type="dice.relationships.Needs" target="storm_vm2_supervisor"/>
      <relationships type="dice.relationships.Needs" target="storm_vm3_supervisor"/>
    </nodeTemplates>
  </tosca:TopologyTemplate>
  <tosca:Import file="http://www.getcloudify.org/spec/cloudify/3.3.1/types.yaml"/>
  <tosca:Import file="http://dice-project.github.io/DICE-FCO-Plugin-Cloudify/0.1.1/plugin.yaml"/>
  <tosca:Import file="http://dice-project.github.io/cloudify-chef-plugin/1.3.2/plugin.yaml"/>
  <tosca:Import file="http://dice-project.github.io/DICE-Deployment-Cloudify/spec/fco/develop/plugin.yaml"/>
</xmi:XMI>
